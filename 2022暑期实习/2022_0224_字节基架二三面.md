## 字节基架二、三面

> 2022.2.24字节基础架构暑期实习
>
> 本来想着去S社了就不面字节了，结果HR说可以暑期，继续面就行，那就接着面呗

## 二面

> 一位目前见到的最年长的面试官

自我介绍。

讲一下你最熟悉的一个project：

LSMDB（每轮都问（除了微软）这可真是太熟悉了

> 讲到一半你说的这些我都知道，我来问你吧。。。

你为什么写这个Project？

你知道有什么公开课讲这个东西吗？

> 这是要给新人做培训？？

内存里为什么不用红黑树？

> 我想了想说dump的时候有序性比较好
>
> 他说可以吧，这个延伸一下就是range query支持比较好。

讲一下写操作。

> 讲到一半他说你这是读操作吧。
>
> 原来他认为的写应该很快返回，不包括compaction，然后我就说我们这个比较naive。。。没有多线程

了解rocksDB吗？

> 不了解，我好菜。

还有什么项目呢？

讲了一下Tiger-compiler。

你是怎么debug的呢？

> gdb yyds

我看到你也用过redis啊，消息队列之类的，你有了解过底层实现吗？

> 没有没有我好菜。

说一说消息队列的应用场景吧？

为什么用redis？

你们有几台机器，并发怎么测的呢？

> 4台机器，Jmeter

你说2000QPS，那就是一台机器每秒500个，也就是一个请求2ms，你知道这两毫秒的请求链路吗？或者说如果想继续优化，改怎么优化吗？

> 好家伙。。。支支吾吾半天说我会分析每一个函数的执行时间。

怎么测呢？

> 又支支吾吾半天，说函数调用前time减调用后time

他说这可以啊，这就是打点法。那些自动化的工具其实也就是这么干的。

> 虚惊一场

我看到你说过图染色，我们来做到图染色的题吧。

一个圆，切n份（即n个扇形），k种颜色，相邻两种颜色不能相同，几种方法？（

> 等分圆上色问题，完全没有了解我好菜

说了个回溯。

写着写着，他说这样复杂度是多少呢？

沉思半晌：$O(n^k)$（好家伙。。。

但并不知道怎么优化，他说那你写吧。

一边写一边说。我为什么出这个题呢？因为我看你写过图染色，虽然不一样，但是人吗，就是要从特殊中提取共性，巴拉巴拉

> 他好喜欢说教啊

写完，你有什么想问我的吗？

我灵魂拷问：实习生能接触到一些比较核心的东西吗？

好家伙这一问，他直接打开话匣子。开始教育我，年轻人巴拉巴拉巴拉巴拉

简而言之就是：

1. 除了核心代码，测试之类的东西都很重要很重要很重要，对业务上线来说。
2. 做测试，debug很辛苦，但不经过这些过程，人无法变强。。。
3. 这些事情能够很快熟悉一个系统。。。
4. 要写核心代码，得证明自己的能力。。。

> 当时感觉我肯定G了，一抬头发现我还是拿S社的账号登的feishu，好家伙。。。

你有时间吗？可以接着面吗？

> 艹，我还要吃饭。。。

当然可以，没问题。

## 三面

自我介绍。

事实证明每一面都能看到前一面写的一些东西，比如这个面试官居然问了我好久malloc。<del>意思是compiler和LSM知道已经被问烂了呗</del> 并没有，还是问LSM了。。。

malloc怎么做的？

碎片怎么办？

> 我直接跟他扯复制式GC

这样GC有什么问题吗？

内部碎片外部碎片是什么？

并发怎么办？

> 拿freelist的锁，且只要拿当前freelist就可以了。
>
> 然后论证了一番不会死锁。面试官表示赞同。

你知道工业界的算法吗？

> 不知道我好菜。

虚拟内存和物理内存差别？虚拟内存怎么组织的。

> 好家伙OS课上听不懂chb dl的我就在看这个。

知道线程和进程吧。

讲一下LSM吧。

了解过RocksDB和LevelDB吗？

> 不知道没了解我好菜。

LSM的优点？

写放大是什么呢？

了解过redis之类的东西的底层实现吗？

> 不知道我真的好菜。

做题：证明一棵树是BST。

上来直接写错，只比较了当前节点和它的左儿子和右儿子。

然后面试官友善的画了棵树指出。

然后提示：你想想BST有什么特点呢？

顿悟：中序有序。

那你准备是把中序的结果存下来吗？

只要存prev就行了。

那你写一下吧。

提问环节：

你来了之后想做什么呢？

> （好家伙，我没有过度解读吧
>
> 我想做底层一点的事情。

你觉得什么是底层呢？

我们做分布式云存储的，够底层了吧？

> （好家伙，我没有过度解读吧

